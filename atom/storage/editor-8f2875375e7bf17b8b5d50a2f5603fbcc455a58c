{"mode":"editor","version":1,"windowDimensions":{"x":363,"y":102,"width":1515,"height":1216},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/brownlee/Documents/code/xd/adobe.com","buffers":[{"text":"/* jshint node:true */\n\nvar hbsRgx = /{{.*?}}/,\n  hbsCache = {},\n  path = require('path');\n\nmodule.exports.register = function(Handlebars, options, params) {\n  'use strict';\n\n  var grunt = params.grunt,\n    bindOptions = params.assemble.options.bind,\n    nsseparator = bindOptions && bindOptions.nsseparator ? bindOptions.nsseparator : ':',\n    dest = bindOptions && bindOptions.dest ? bindOptions.dest : undefined;\n\n  Handlebars.registerHelper('data', function(prop, opts) {\n    if (typeof prop !== 'string') {\n      throw 'Not a string value passed to the bind helper!';\n    }\n\n    var nsIdx = prop.indexOf(nsseparator),\n      ns = prop.substring(0, nsIdx) || opts.hash.ns || undefined,\n      props = prop.substring(nsIdx + 1).split('.'),\n      value,\n      root = opts.hash.root || this,\n      ctx = root,\n      isNew = false,\n      defaultValue = opts.fn ? opts.fn(this) : prop;\n\n    if (ns) {\n      ctx = root[ns] || (root[ns] = {});\n    }\n\n    props.forEach(function(p, i) {\n      var v = ctx[p];\n\n      if (i === props.length - 1) { // Checking if last\n\n        if (v === undefined) {\n          isNew = true;\n          v = ctx[p] = defaultValue;\n        }\n\n        value = v;\n\n      } else {\n\n        if (v === null || typeof v !== 'object') {\n          isNew = true;\n          v = ctx[p] = {};\n        }\n\n        ctx = v;\n      }\n\n    });\n\n    if (ns && isNew && dest) {\n      var file = path.join(dest, ns + '.json'),\n          jsonStr = JSON.stringify(root[ns], null, 2);\n\n      if (!jsonStr) {\n        grunt.log.error('ns:', ns);\n        grunt.log.error('key:', props.join('.'));\n        grunt.log.error('root:', root);\n        throw 'Wrong context root, can\\'t save empty JSON file!';\n      }\n      grunt.file.write(file, jsonStr);\n      grunt.log.writeln('Updated', file, 'with new property', props.join('.'));\n    }\n\n    if (typeof value === 'string') {\n      if (hbsRgx.test(value)) {\n        var tpl = hbsCache[value] || (hbsCache[value] = Handlebars.compile(value));\n        value = tpl(root);\n      }\n      return new Handlebars.SafeString(value);\n    } else {\n      return value;\n    }\n  });\n\n  Handlebars.registerHelper('concat', function() {\n    var args = Array.prototype.slice.call(arguments, 0);\n    args.pop();\n    return args.join('');\n  });\n\n  Handlebars.registerHelper('arrify', function(obj) {\n    var array = [];\n    Object.keys(obj).forEach(function(key) {\n      array.push({\n        key: key,\n        val: obj[key]\n      });\n    });\n    return array;\n  });\n};\n","markers":{"markers":{"1":{"id":1,"range":[[51,16],[51,16]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":276,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/brownlee/Documents/code/xd/adobe.com/homepage/helpers/assemble-handlebars-data.js","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"dc1d3465c76bb865430e5861cff24937aebcc1e1","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":276,"softTabs":true,"displayBuffer":{"id":277,"softWrap":false,"editorWidthInChars":111,"scrollTop":531,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/brownlee/Documents/code/xd/adobe.com/homepage/helpers/assemble-handlebars-data.js","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/brownlee/Documents/code/xd/adobe.com/homepage/helpers/assemble-handlebars-data.js","focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/brownlee/Documents/code/xd/adobe.com/homepage/helpers/assemble-handlebars-data.js":1398706542176},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":2452124},"tree-view":{"directoryExpansionStates":{"homepage":{"helpers":{},"sitecat":{}}},"selectedPath":"/Users/brownlee/Documents/code/xd/adobe.com/homepage/helpers/assemble-handlebars-data.js","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":254},"find-and-replace":{"viewState":{"findHistory":["createNs"],"replaceHistory":[],"modelState":{"useRegex":false,"inCurrentSelection":false,"caseSensitive":false}}}}}